<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kelola Dokter - Rekam Medis</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        <a class="navbar-brand" href="#">Kelola Dokter</a>
        <a class="btn btn-light btn-sm" href="dashboard.html">Kembali</a>
    </div>
</nav>

<!-- CONTENT -->
<div class="container mt-4">
    <h3 class="mb-3">Data Dokter</h3>

    <button class="btn btn-success mb-3" data-bs-toggle="modal" data-bs-target="#addDoctorModal">
        <i class="fa fa-plus"></i> Tambah Dokter
    </button>

    <table class="table table-bordered table-striped">
        <thead class="table-primary">
            <tr>
                <th width="10%">ID</th>
                <th>Nama Dokter</th>
                <th>Spesialisasi</th>
                <th width="20%">Aksi</th>
            </tr>
        </thead>
        <tbody id="doctorsTable">
            <!-- DATA MUNCUL DI SINI -->
        </tbody>
    </table>
</div>

<!-- MODAL TAMBAH -->
<div class="modal fade" id="addDoctorModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="addDoctorForm">
                <div class="modal-header">
                    <h5 class="modal-title">Tambah Dokter</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label>Nama Dokter</label>
                        <input type="text" id="doctorName" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label>Spesialisasi</label>
                        <input type="text" id="doctorSpecialty" class="form-control" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary">Simpan</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- MODAL EDIT -->
<div class="modal fade" id="editDoctorModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="editDoctorForm">
                <input type="hidden" id="editDoctorId">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Dokter</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label>Nama Dokter</label>
                        <input type="text" id="editDoctorName" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label>Spesialisasi</label>
                        <input type="text" id="editDoctorSpecialty" class="form-control" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary">Update</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- SCRIPT -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
/* ===============================
   DATA (localStorage)
================================ */
let doctors = JSON.parse(localStorage.getItem('doctors')) || [];

function saveData() {
    localStorage.setItem('doctors', JSON.stringify(doctors));
}

function generateId() {
    return doctors.length ? doctors[doctors.length - 1].id + 1 : 1;
}

/* ===============================
   LOAD DATA
================================ */
function loadDoctors() {
    const tbody = document.getElementById('doctorsTable');
    tbody.innerHTML = '';

    if (doctors.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="4" class="text-center text-muted">
                    Belum ada data dokter
                </td>
            </tr>`;
        return;
    }

    doctors.forEach(d => {
        tbody.innerHTML += `
            <tr>
                <td>${d.id}</td>
                <td>${d.name}</td>
                <td>${d.specialty}</td>
                <td>
                    <button class="btn btn-warning btn-sm" onclick="editDoctor(${d.id})">
                        <i class="fa fa-edit"></i>
                    </button>
                    <button class="btn btn-danger btn-sm" onclick="deleteDoctor(${d.id})">
                        <i class="fa fa-trash"></i>
                    </button>
                </td>
            </tr>`;
    });
}

document.addEventListener('DOMContentLoaded', loadDoctors);

/* ===============================
   TAMBAH
================================ */
document.getElementById('addDoctorForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const name = doctorName.value.trim();
    const specialty = doctorSpecialty.value.trim();

    doctors.push({
        id: generateId(),
        name,
        specialty
    });

    saveData();
    loadDoctors();

    bootstrap.Modal.getInstance(addDoctorModal).hide();
    this.reset();
});

/* ===============================
   EDIT
================================ */
function editDoctor(id) {
    const d = doctors.find(x => x.id === id);
    editDoctorId.value = d.id;
    editDoctorName.value = d.name;
    editDoctorSpecialty.value = d.specialty;

    new bootstrap.Modal(editDoctorModal).show();
}

document.getElementById('editDoctorForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const id = parseInt(editDoctorId.value);
    const index = doctors.findIndex(d => d.id === id);

    doctors[index].name = editDoctorName.value;
    doctors[index].specialty = editDoctorSpecialty.value;

    saveData();
    loadDoctors();
    bootstrap.Modal.getInstance(editDoctorModal).hide();
});

/* ===============================
   DELETE
================================ */
function deleteDoctor(id) {
    if (confirm('Yakin hapus dokter ini?')) {
        doctors = doctors.filter(d => d.id !== id);
        saveData();
        loadDoctors();
    }
}
</script>

</body>
</html>