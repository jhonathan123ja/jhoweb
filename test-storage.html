<!DOCTYPE html>
<html>
<head>
    <title>Test Doctor Add Functionality</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 20px; background: #f5f5f5; }
        .test-section { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .success { color: green; }
        .error { color: red; }
        pre { background: #f0f0f0; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ”§ Test Doctor Add Functionality</h1>
        
        <div class="test-section">
            <h3>1. Test localStorage</h3>
            <button class="btn btn-primary" onclick="testLocalStorage()">Test localStorage</button>
            <div id="localStorageResult"></div>
        </div>
        
        <div class="test-section">
            <h3>2. Simulate Adding Doctor</h3>
            <input type="text" id="testName" class="form-control mb-2" placeholder="Nama Dokter">
            <input type="text" id="testSpecialty" class="form-control mb-2" placeholder="Spesialisasi">
            <button class="btn btn-success" onclick="simulateAddDoctor()">Simulasi Tambah Dokter</button>
            <div id="simulateResult"></div>
        </div>
        
        <div class="test-section">
            <h3>3. Check All Doctors</h3>
            <button class="btn btn-info" onclick="checkDoctors()">Check Doctors in Storage</button>
            <div id="doctorsResult"></div>
        </div>
        
        <div class="test-section">
            <h3>4. Clear All Data</h3>
            <button class="btn btn-danger" onclick="clearAll()">Clear All localStorage</button>
            <div id="clearResult"></div>
        </div>
    </div>
    
    <script>
        function testLocalStorage() {
            const result = document.getElementById('localStorageResult');
            result.innerHTML = '';
            
            try {
                localStorage.setItem('test', 'works');
                const val = localStorage.getItem('test');
                result.innerHTML += '<p class="success">âœ“ localStorage tersedia</p>';
                
                // Check structure
                let doctors = JSON.parse(localStorage.getItem('doctors')) || [];
                result.innerHTML += '<p>Doctors array: ' + doctors.length + ' item(s)</p>';
                
            } catch(e) {
                result.innerHTML += '<p class="error">âœ— Error: ' + e.message + '</p>';
            }
        }
        
        function simulateAddDoctor() {
            const result = document.getElementById('simulateResult');
            result.innerHTML = '';
            
            const name = document.getElementById('testName').value.trim();
            const specialty = document.getElementById('testSpecialty').value.trim();
            
            if (!name || !specialty) {
                result.innerHTML += '<p class="error">âœ— Nama dan spesialisasi harus diisi</p>';
                return;
            }
            
            try {
                let doctors = JSON.parse(localStorage.getItem('doctors')) || [];
                result.innerHTML += '<p>Before: ' + doctors.length + ' dokter</p>';
                
                doctors.push({ name, specialty, phone: '', email: '' });
                localStorage.setItem('doctors', JSON.stringify(doctors));
                
                let doctorsAfter = JSON.parse(localStorage.getItem('doctors')) || [];
                result.innerHTML += '<p class="success">âœ“ After: ' + doctorsAfter.length + ' dokter</p>';
                result.innerHTML += '<p>Dokter terakhir: ' + JSON.stringify(doctorsAfter[doctorsAfter.length - 1]) + '</p>';
                
                document.getElementById('testName').value = '';
                document.getElementById('testSpecialty').value = '';
                
            } catch(e) {
                result.innerHTML += '<p class="error">âœ— Error: ' + e.message + '</p>';
            }
        }
        
        function checkDoctors() {
            const result = document.getElementById('doctorsResult');
            result.innerHTML = '';
            
            try {
                let doctors = JSON.parse(localStorage.getItem('doctors')) || [];
                result.innerHTML += '<p>Total dokter: ' + doctors.length + '</p>';
                result.innerHTML += '<pre>' + JSON.stringify(doctors, null, 2) + '</pre>';
            } catch(e) {
                result.innerHTML += '<p class="error">âœ— Error: ' + e.message + '</p>';
            }
        }
        
        function clearAll() {
            const result = document.getElementById('clearResult');
            try {
                localStorage.clear();
                result.innerHTML += '<p class="success">âœ“ Semua data dihapus</p>';
                checkDoctors();
            } catch(e) {
                result.innerHTML += '<p class="error">âœ— Error: ' + e.message + '</p>';
            }
        }
        
        // Show initial state
        window.addEventListener('load', function() {
            checkDoctors();
        });
